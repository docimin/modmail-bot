import{S as re,i as ne,s as ce,l as k,r as Y,a as j,m as y,n as E,u as x,h as p,c as N,p as _,G as oe,b as U,H as I,a0 as C,I as O,a1 as ee,t as R,d as ue,f as G,Z as fe,o as de,g as he,w as te,x as se,y as le,E as ae,B as ie,q as S,J as P}from"../../chunks/index-dd217174.js";import{g as me}from"../../chunks/navigation-75a744b1.js";import{R as _e}from"../../chunks/Rolling-64aaf242.js";import{I as pe}from"../../chunks/InfiniteScroll-48a8f2e2.js";import"../../chunks/singletons-eca981c1.js";function J(c,e,i){const l=c.slice();return l[14]=e[i],l}function Z(c,e,i){const l=c.slice();return l[17]=e[i],l}function K(c,e,i){const l=c.slice();return l[17]=e[i],l}function ve(c){let e,i,l;return i=new _e({props:{style:"transform: scale(.2);"}}),{c(){e=k("div"),te(i.$$.fragment),this.h()},l(a){e=y(a,"DIV",{class:!0});var o=E(e);se(i.$$.fragment,o),o.forEach(p),this.h()},h(){_(e,"class","loading svelte-1wcasmu")},m(a,o){U(a,e,o),le(i,e,null),l=!0},p:ae,i(a){l||(G(i.$$.fragment,a),l=!0)},o(a){R(i.$$.fragment,a),l=!1},d(a){a&&p(e),ie(i)}}}function ge(c){let e,i,l,a,o,m=c[3],s=[];for(let t=0;t<m.length;t+=1)s[t]=Q(K(c,m,t));let f=c[1],n=[];for(let t=0;t<f.length;t+=1)n[t]=X(J(c,f,t));return a=new pe({}),a.$on("loadMore",c[10]),{c(){e=k("div");for(let t=0;t<s.length;t+=1)s[t].c();i=j();for(let t=0;t<n.length;t+=1)n[t].c();l=j(),te(a.$$.fragment),this.h()},l(t){e=y(t,"DIV",{class:!0,style:!0});var d=E(e);for(let r=0;r<s.length;r+=1)s[r].l(d);d.forEach(p),i=N(t);for(let r=0;r<n.length;r+=1)n[r].l(t);l=N(t),se(a.$$.fragment,t),this.h()},h(){_(e,"class","ticket columns-template svelte-1wcasmu"),S(e,"z-index","100")},m(t,d){U(t,e,d);for(let r=0;r<s.length;r+=1)s[r].m(e,null);U(t,i,d);for(let r=0;r<n.length;r+=1)n[r].m(t,d);U(t,l,d),le(a,t,d),o=!0},p(t,d){if(d&8){m=t[3];let r;for(r=0;r<m.length;r+=1){const $=K(t,m,r);s[r]?s[r].p($,d):(s[r]=Q($),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=m.length}if(d&14){f=t[1];let r;for(r=0;r<f.length;r+=1){const $=J(t,f,r);n[r]?n[r].p($,d):(n[r]=X($),n[r].c(),n[r].m(l.parentNode,l))}for(;r<n.length;r+=1)n[r].d(1);n.length=f.length}},i(t){o||(G(a.$$.fragment,t),o=!0)},o(t){R(a.$$.fragment,t),o=!1},d(t){t&&p(e),P(s,t),t&&p(i),P(n,t),t&&p(l),ie(a,t)}}}function Q(c){let e,i=c[17].label+"",l;return{c(){e=k("div"),l=Y(i),this.h()},l(a){e=y(a,"DIV",{class:!0,style:!0});var o=E(e);l=x(o,i),o.forEach(p),this.h()},h(){_(e,"class","column "+c[17].id+" svelte-1wcasmu"),S(e,"width",c[17].width+"%"),S(e,"min-width",c[17].minwidth+"px")},m(a,o){U(a,e,o),I(e,l)},p:ae,d(a){a&&p(e)}}}function W(c){let e,i=c[17].get(c[14],c[2])+"";return{c(){e=k("div"),this.h()},l(l){e=y(l,"DIV",{class:!0,style:!0});var a=E(e);a.forEach(p),this.h()},h(){_(e,"class","column "+c[17].id+" svelte-1wcasmu"),S(e,"width",c[17].width+"%"),S(e,"min-width",c[17].minwidth+"px")},m(l,a){U(l,e,a),e.innerHTML=i},p(l,a){a&6&&i!==(i=l[17].get(l[14],l[2])+"")&&(e.innerHTML=i)},d(l){l&&p(e)}}}function X(c){let e,i,l,a=c[3],o=[];for(let s=0;s<a.length;s+=1)o[s]=W(Z(c,a,s));function m(){return c[9](c[14])}return{c(){e=k("button");for(let s=0;s<o.length;s+=1)o[s].c();this.h()},l(s){e=y(s,"BUTTON",{class:!0});var f=E(e);for(let n=0;n<o.length;n+=1)o[n].l(f);f.forEach(p),this.h()},h(){_(e,"class","ticket svelte-1wcasmu")},m(s,f){U(s,e,f);for(let n=0;n<o.length;n+=1)o[n].m(e,null);i||(l=O(e,"click",ee(m)),i=!0)},p(s,f){if(c=s,f&14){a=c[3];let n;for(n=0;n<a.length;n+=1){const t=Z(c,a,n);o[n]?o[n].p(t,f):(o[n]=W(t),o[n].c(),o[n].m(e,null))}for(;n<o.length;n+=1)o[n].d(1);o.length=a.length}},d(s){s&&p(e),P(o,s),i=!1,l()}}}function we(c){let e,i,l,a,o,m,s,f,n,t,d,r,$,V,T,w,u,v,h,q;const z=[ge,ve],D=[];function B(g,b){return g[1]?0:1}return w=B(c),u=D[w]=z[w](c),{c(){e=k("div"),i=k("div"),l=k("span"),a=Y("Tickets"),o=j(),m=k("form"),s=k("input"),n=j(),t=k("button"),d=k("img"),V=j(),T=k("div"),u.c(),this.h()},l(g){e=y(g,"DIV",{class:!0});var b=E(e);i=y(b,"DIV",{class:!0});var M=E(i);l=y(M,"SPAN",{class:!0});var F=E(l);a=x(F,"Tickets"),F.forEach(p),o=N(M),m=y(M,"FORM",{class:!0});var L=E(m);s=y(L,"INPUT",{type:!0,placeholder:!0,class:!0}),n=N(L),t=y(L,"BUTTON",{type:!0,class:!0});var H=E(t);d=y(H,"IMG",{src:!0,alt:!0,class:!0}),H.forEach(p),L.forEach(p),M.forEach(p),V=N(b),T=y(b,"DIV",{class:!0});var A=E(T);u.l(A),A.forEach(p),b.forEach(p),this.h()},h(){_(l,"class","svelte-1wcasmu"),_(s,"type","text"),_(s,"placeholder","ID / Grund / Nachricht"),s.disabled=f=!c[1],_(s,"class","svelte-1wcasmu"),oe(d.src,r="/assets/icons/search-thin.svg")||_(d,"src",r),_(d,"alt","search"),_(d,"class","svelte-1wcasmu"),_(t,"type","submit"),_(t,"class","svelte-1wcasmu"),_(m,"class",$="search "+(c[1]?"":"disabled")+" svelte-1wcasmu"),_(i,"class","header svelte-1wcasmu"),_(T,"class","tickets svelte-1wcasmu"),_(e,"class","container svelte-1wcasmu")},m(g,b){U(g,e,b),I(e,i),I(i,l),I(l,a),I(i,o),I(i,m),I(m,s),C(s,c[0]),I(m,n),I(m,t),I(t,d),I(e,V),I(e,T),D[w].m(T,null),v=!0,h||(q=[O(s,"input",c[7]),O(m,"submit",ee(c[8]))],h=!0)},p(g,[b]){(!v||b&2&&f!==(f=!g[1]))&&(s.disabled=f),b&1&&s.value!==g[0]&&C(s,g[0]),(!v||b&2&&$!==($="search "+(g[1]?"":"disabled")+" svelte-1wcasmu"))&&_(m,"class",$);let M=w;w=B(g),w===M?D[w].p(g,b):(he(),R(D[M],1,1,()=>{D[M]=null}),ue(),u=D[w],u?u.p(g,b):(u=D[w]=z[w](g),u.c()),G(u,1),u.m(T,null))},i(g){v||(G(u),v=!0)},o(g){R(u),v=!1},d(g){g&&p(e),D[w].d(),h=!1,fe(q)}}}function be(c,e,i){let l,a=new Map,o=[{id:"id",label:"ID",get:u=>u.id,width:10,minwidth:120},{id:"user",label:"User",get:u=>{var v,h;return a.get(u.userId)?`
    <div style="display: flex; align-items: center; column-gap: 8px;">
     <img src="${(v=a.get(u.userId))==null?void 0:v.avatarURL}" alt="avatar" style="width: 32px; border-radius: 50%;" />
     <div style="display: flex; flex-direction: column; font-size: .9em;">
      <span>${(h=a.get(u.userId))==null?void 0:h.tag}</span>
      <span style="font-size: .9em; opacity: 80%;">${u.userId}</span>
     </div>
    </div>
   `:u.userId},width:20,minwidth:170},{id:"reason",label:"Grund",get:u=>u.reason||"/",width:40,minwidth:100},{id:"created",label:"Erstellt",get:u=>new Date(parseInt(u.createdTimestamp)).toLocaleString(),width:10,minwidth:130}];de(async()=>{let u=await fetch("/api/v1/tickets");u.status===200&&i(1,l=await u.json()),m()});async function m(){let u=[...new Set(l.map(h=>h.userId))],v=await fetch(`/api/v1/users?${u.map(h=>`userId=${h}`).join("&")}`);if(v.status===200){for(let h of await v.json())a.set(h.id,{...h,tag:`${h.username}#${h.discriminator}`,avatarURL:h.avatar?`https://cdn.discordapp.com/avatars/${h.id}/${h.avatar}.png`:"https://discord.com/assets/1f0bfc0865d324c2587920a7d80c609b.png"});i(2,a=Object.assign(a))}}let s="",f=!0;async function n(u=!1){i(1,l=[]);let v=s?`filter=${s}`:"",h=await fetch(`/api/v1/tickets${v?`?${v} `:""}`);h.status===200&&(i(1,l=await h.json()),l.length===0&&s&&!u&&n(!0))}let t=0,d=50;async function r(){t=d,d+=50;let u=s?`filter=${s}`:"",v=await fetch(`/api/v1/tickets?start=${t}&limit=${d}${u?`&${u} `:""}`);if(v.status===200){let h=await v.json();i(1,l=[...l,...h])}m()}function $(){s=this.value,i(0,s)}const V=()=>n(),T=u=>me(`/tickets/${u.id}`),w=()=>r();return c.$$.update=()=>{c.$$.dirty&65&&s&&f&&i(6,f=!1),c.$$.dirty&65&&!s&&!f&&(i(6,f=!0),n())},[s,l,a,o,n,r,f,$,V,T,w]}class Te extends re{constructor(e){super(),ne(this,e,be,we,ce,{})}}export{Te as default};
